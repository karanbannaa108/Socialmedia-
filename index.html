<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KaranZeroDay Bot Hosting</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#0a0a0f;--card:#11111a;--accent:#8b5cf6;--glow:rgba(139,92,246,0.4);}
        *{margin:0;padding:0;box-sizing:border-box;}
        body{background:var(--bg);color:#fff;font-family:'Inter',sans-serif;min-height:100vh;padding:20px;}
        .header{text-align:center;padding:40px 0;}
        h1{font-size:3.5rem;font-weight:900;background:linear-gradient(135deg,#c084fc,#818cf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
        .dash{background:var(--card);border-radius:24px;padding:30px;max-width:900px;margin:0 auto;border:1px solid rgba(255,255,255,0.08);box-shadow:0 20px 50px rgba(0,0,0,0.5);}
        .upload{border:2px dashed var(--accent);border-radius:20px;padding:50px;text-align:center;cursor:pointer;transition:0.4s;margin-bottom:30px;}
        .upload:hover{background:rgba(139,92,246,0.1);}
        .controls{display:flex;gap:15px;flex-wrap:wrap;justify-content:center;margin:30px 0;}
        .btn{background:var(--accent);padding:16px 32px;border-radius:50px;cursor:pointer;font-weight:700;transition:0.3s;}
        .btn.stop{background:#ef4444;}.btn.restart{background:#f59e0b;}
        .btn:hover{transform:scale(1.05);}
        .console{background:#000;padding:20px;height:400px;overflow-y:auto;font-family:monospace;border-radius:16px;margin-top:20px;color:#0f0;}
        .status{text-align:center;font-size:1.2rem;font-weight:700;margin:20px 0;}
        .online{color:#10b981;}.offline{color:#ef4444;}
    </style>
</head>
<body>
    <div class="header">
        <h1>KaranZeroDay</h1>
        <p>Free Python Bot Hosting • Single File • 100% Working</p>
    </div>
    <div class="dash">
        <div class="upload" onclick="document.getElementById('zipfile').click()">
            <h3>Upload Bot ZIP (main.py / bot.py / nm.py)</h3>
            <input type="file" id="zipfile" accept=".zip" style="display:none">
            <p id="filename">No file selected</p>
        </div>

        <div class="controls">
            <div class="btn" onclick="uploadBot()">Upload & Run</div>
            <div class="btn stop" onclick="stopBot()">Stop</div>
            <div class="btn restart" onclick="restartBot()">Restart</div>
        </div>

        <div class="status">Status: <span id="status" class="offline">Offline</span></div>
        <div class="console" id="console">> Ready... Upload ZIP to start bot</div>
    </div>

    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.1/full/pyodide.js"></script>
    <script>
        let pyodide;
        let botRunning = false;

        async function main() {
            console.log("Loading Pyodide...");
            document.getElementById("console").innerHTML += "<br>Loading Python engine...";
            pyodide = await loadPyodide();
            await pyodide.loadPackage("micropip");
            document.getElementById("console").innerHTML += "<br>Python engine ready!";
        }
        main();

        function log(msg) {
            const consoleEl = document.getElementById("console");
            consoleEl.innerHTML += "<br>> " + msg;
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        async function uploadBot() {
            const input = document.getElementById("zipfile");
            if (!input.files[0]) return alert("Pehle ZIP file select karo!");

            if (!pyodide) {
                alert("Python engine abhi load ho raha hai, thodi der wait karo...");
                return;
            }

            const file = input.files[0];
            document.getElementById("filename").textContent = file.name;
            log(`Uploading ${file.name}...`);

            const buffer = await file.arrayBuffer();
            const data = new Uint8Array(buffer);

            try {
                log("Extracting ZIP...");
                await pyodide.runPythonAsync(`
                    import zipfile, io
                    from js import Uint8Array
                    zip_data = bytes(Uint8Array.new(${data}))
                    with zipfile.ZipFile(io.BytesIO(zip_data)) as z:
                        for info in z.infolist():
                            if info.is_dir(): continue
                            with open(info.filename, 'wb') as f:
                                f.write(z.read(info))
                    print("ZIP extracted successfully")
                `);

                const startup = await pyodide.runPythonAsync(`
                    import os
                    files = ["main.py", "bot.py", "nm.py", "index.py", "start.py"]
                    for f in files:
                        if os.path.exists(f):
                            print(f"Found startup file: {f}")
                            f
                            break
                    else:
                        None
                `);

                if (startup) {
                    log(`Starting ${startup}...`);
                    document.getElementById("status").textContent = "Online";
                    document.getElementById("status").className = "online";
                    botRunning = true;

                    // Run bot with real output
                    pyodide.setStdout({ batched: (str) => log(str) });
                    pyodide.setStderr({ batched: (str) => log("ERROR: " + str) });

                    await pyodide.runPythonAsync(`exec(open("${startup}").read())`);
                    log("Bot stopped.");
                } else {
                    log("Error: main.py, bot.py, nm.py nahi mila!");
                }
            } catch (e) {
                log("Error: " + e.message);
            }
        }

        function stopBot() {
            if (botRunning) {
                log("Bot stopped by user");
                document.getElementById("status").textContent = "Offline";
                document.getElementById("status").className = "offline";
                botRunning = false;
            }
        }

        function restartBot() {
            stopBot();
            setTimeout(uploadBot, 1000);
        }
    </script>
</body>
</html>
